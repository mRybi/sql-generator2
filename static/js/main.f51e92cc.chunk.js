(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,a){},110:function(e,t,a){},163:function(e,t,a){},236:function(e,t,a){},238:function(e,t,a){},240:function(e,t,a){},242:function(e,t,a){},245:function(e,t,a){"use strict";a.r(t);a(83),a(85),a(87),a(89),a(27);var i=a(0),n=a.n(i),r=a(1),o=a(4),l=a(3),s=a(5),c=a(2),u=a(6),d=a(10),m=a(11),p=a.n(m),g=a(17),h=function(e){function t(e){var a;return Object(r.a)(this,t),console.log("ctor label"),(a=Object(s.a)(this,Object(c.a)(t).call(this,"custom"))).label=void 0,a.isFirst=void 0,a.label=e,a.offsetY=-23,a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"setLabel",value:function(e){this.label=e}},{key:"deSerialize",value:function(e,a){Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.label=e.label}},{key:"serialize",value:function(){return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{label:this.label})}}]),t}(l.LabelModel),b=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"custom";return Object(r.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).call(this,a))).width=void 0,e.color=void 0,e.curvyness=void 0,e.properties=void 0,e.color="rgba(255,255,255,0.5)",e.width=3,e.curvyness=0,e.addLabel("0,N"),e.addLabel("relation name"),e.addLabel("0,N"),e.properties=new k(!1,"relNode"),e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"serialize",value:function(){var e=this.properties&&this.properties.ports&&Object.values(this.properties.ports),a=e&&e.map(function(e){return{label:e.label,propertyType:e.propertyType,isPrimaryKey:e.isPrimaryKey,isNotNull:e.isNotNull,isAutoincremented:e.isAutoincremented,isUnique:e.isUnique}});return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{width:this.width,color:this.color,curvyness:this.curvyness,properties:a})}},{key:"deSerialize",value:function(e,a){var i=new k(!1,"relNode");i.ports=e.properties.map(function(e){return{label:e.label,propertyType:e.propertyType,isPrimaryKey:e.isPrimaryKey,isNotNull:e.isNotNull,isAutoincremented:e.isAutoincremented,isUnique:e.isUnique}}),console.log("obj",e.properties),Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.color=e.color,this.width=e.width,this.curvyness=e.curvyness,this.properties=i}},{key:"addLabel",value:function(e){if(e instanceof l.LabelModel)return Object(d.a)(Object(c.a)(t.prototype),"addLabel",this).call(this,e);var a=new h("custom");return a.setLabel(e),Object(d.a)(Object(c.a)(t.prototype),"addLabel",this).call(this,a)}},{key:"setWidth",value:function(e){this.width=e,this.iterateListeners(function(t,a){t.widthChanged&&t.widthChanged(Object(g.a)({},a,{width:e}))})}},{key:"setColor",value:function(e){this.color=e,this.iterateListeners(function(t,a){t.colorChanged&&t.colorChanged(Object(g.a)({},a,{color:e}))})}}]),t}(l.LinkModel),f=function(e){function t(e,a,i,n,o,l,u,d,m,p){var g;return Object(r.a)(this,t),(g=Object(s.a)(this,Object(c.a)(t).call(this,e,"custom",m))).in=void 0,g.isNamePort=void 0,g.label=void 0,g.links=void 0,g.isPrimaryKey=void 0,g.isPartialKey=void 0,g.isForeignKey=void 0,g.isAutoincremented=void 0,g.isNotNull=void 0,g.isUnique=void 0,g.propertyType=void 0,g.fkPortId=void 0,g.label=e,g.isNamePort=a,g.links={},g.isPrimaryKey=i,g.isForeignKey=n,g.isPartialKey=!1,g.isNotNull=o,g.isUnique=u,g.isAutoincremented=l,g.propertyType=d,g.fkPortId=p,g}return Object(u.a)(t,e),Object(o.a)(t,[{key:"deSerialize",value:function(e,a){Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.label=e.label,this.isNamePort=e.isNamePort,this.isPrimaryKey=e.isPrimaryKey,this.isPartialKey=e.isPartialKey,this.isForeignKey=e.isForeignKey,this.isNotNull=e.isNotNull,this.isUnique=e.isUnique,this.isAutoincremented=e.isAutoincremented,this.propertyType=e.propertyType,this.fkPortId=e.fkPortId}},{key:"serialize",value:function(){return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{label:this.label,links:this.links,isNamePort:this.isNamePort,isPrimaryKey:this.isPrimaryKey,isPartialKey:this.isPartialKey,isForeignKey:this.isForeignKey,isNotNull:this.isNotNull,isUnique:this.isUnique,isAutoincremented:this.isAutoincremented,propertyType:this.propertyType,fkPortId:this.fkPortId})}},{key:"canLinkToPort",value:function(e){return!0}},{key:"createLinkModel",value:function(){return new b("custom")}}]),t}(l.PortModel),y=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"custom",i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(r.a)(this,t),(e=Object(s.a)(this,Object(c.a)(t).call(this,a))).width=void 0,e.color=void 0,e.curvyness=void 0,e.properties=void 0,e.color="rgba(255,255,255,0.5)",e.width=3,e.curvyness=0,e.addLabel(i),e.addLabel(n),e.properties=new k(!1,"relNode"),e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"serialize",value:function(){var e=this.properties&&this.properties.ports&&Object.values(this.properties.ports),a=e&&e.map(function(e){return{label:e.label,propertyType:e.propertyType,isPrimaryKey:e.isPrimaryKey,isNotNull:e.isNotNull,isAutoincremented:e.isAutoincremented,isUnique:e.isUnique}});return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{width:this.width,color:this.color,curvyness:this.curvyness,properties:a})}},{key:"deSerialize",value:function(e,a){var i=new k(!1,"relNode");i.ports=e.properties.map(function(e){return{label:e.label,propertyType:e.propertyType,isPrimaryKey:e.isPrimaryKey,isNotNull:e.isNotNull,isAutoincremented:e.isAutoincremented,isUnique:e.isUnique}}),console.log("obj",e.properties),Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.color=e.color,this.width=e.width,this.curvyness=e.curvyness,this.properties=i}},{key:"addLabel",value:function(e){if(e instanceof l.LabelModel)return Object(d.a)(Object(c.a)(t.prototype),"addLabel",this).call(this,e);var a=new h("custom");return a.setLabel(e),Object(d.a)(Object(c.a)(t.prototype),"addLabel",this).call(this,a)}},{key:"setWidth",value:function(e){this.width=e,this.iterateListeners(function(t,a){t.widthChanged&&t.widthChanged(Object(g.a)({},a,{width:e}))})}},{key:"setColor",value:function(e){this.color=e,this.iterateListeners(function(t,a){t.colorChanged&&t.colorChanged(Object(g.a)({},a,{color:e}))})}}]),t}(l.LinkModel),v=function(e){function t(e,a,i,n,o,l,u,d,m,p){var g;return Object(r.a)(this,t),(g=Object(s.a)(this,Object(c.a)(t).call(this,e,"custom",m))).in=void 0,g.isNamePort=void 0,g.label=void 0,g.links=void 0,g.isPrimaryKey=void 0,g.isPartialKey=void 0,g.isForeignKey=void 0,g.isAutoincremented=void 0,g.isNotNull=void 0,g.isUnique=void 0,g.propertyType=void 0,g.fkPortId=void 0,g.label=e,g.isNamePort=a,g.links={},g.isPrimaryKey=i,g.isForeignKey=n,g.isPartialKey=!1,g.isNotNull=o,g.isUnique=u,g.isAutoincremented=l,g.propertyType=d,g.fkPortId=p,g}return Object(u.a)(t,e),Object(o.a)(t,[{key:"deSerialize",value:function(e,a){Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.label=e.label,this.isNamePort=e.isNamePort,this.isPrimaryKey=e.isPrimaryKey,this.isPartialKey=e.isPartialKey,this.isForeignKey=e.isForeignKey,this.isNotNull=e.isNotNull,this.isUnique=e.isUnique,this.isAutoincremented=e.isAutoincremented,this.propertyType=e.propertyType,this.fkPortId=e.fkPortId}},{key:"serialize",value:function(){return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{label:this.label,links:this.links,isNamePort:this.isNamePort,isPrimaryKey:this.isPrimaryKey,isPartialKey:this.isPartialKey,isForeignKey:this.isForeignKey,isNotNull:this.isNotNull,isUnique:this.isUnique,isAutoincremented:this.isAutoincremented,propertyType:this.propertyType,fkPortId:this.fkPortId})}},{key:"canLinkToPort",value:function(e){var t=this.getParent(),a=e.getParent(),i=a.getPorts(),n=t.getPorts(),r=Object.keys(n).filter(function(e){return n[e].fkPortId===a.id})[0],o=Object.keys(i).filter(function(e){return i[e].fkPortId===t.id})[0],l=Object.keys(n).filter(function(e){return n[e].isPrimaryKey})[0];return r||o||a.addInPort(!0,!1,t.name+n[l].name,!1,!0,!1,!1,!0,"INT",t.id),!0}},{key:"createLinkModel",value:function(){return new y("custom","1","N")}}]),t}(l.PortModel),k=function(e){function t(e){var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Untitled",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb(0,192,255)";return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,"custom"))).name=void 0,a.color=void 0,a.ports=void 0,a.isLabel=void 0,a.name=i,a.color=n,a.ports={},a.isLabel=e,a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"addInPort",value:function(e,t,a,i,n,r,o,s,c,u){return e?this.addPort(new v(a,t,i,n,s,o,r,c,l.Toolkit.UID(),u)):this.addPort(new f(a,t,i,n,s,o,r,c,l.Toolkit.UID(),u))}},{key:"addOutPort",value:function(e,t,a,i,n,r,o,s){return this.addPort(new f(t,e,a,i,o,r,n,s,l.Toolkit.UID()))}},{key:"deSerialize",value:function(e,a){Object(d.a)(Object(c.a)(t.prototype),"deSerialize",this).call(this,e,a),this.name=e.name,this.color=e.color,this.isLabel=e.isLabel}},{key:"serialize",value:function(){return m.merge(Object(d.a)(Object(c.a)(t.prototype),"serialize",this).call(this),{name:this.name,color:this.color,isLabel:this.isLabel})}},{key:"getInPorts",value:function(){return m.filter(this.ports,function(e){return e.in})}},{key:"getOutPorts",value:function(){return m.filter(this.ports,function(e){return!e.in})}}]),t}(l.NodeModel),E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,"srd-default-node",e))).state={},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",Object.assign({},this.getProps(),{style:{background:this.props.node.color}}),i.createElement("div",{className:this.bem("__title")},i.createElement("div",{className:this.bem("__name")},this.props.node.name)))}}]),t}(l.BaseWidget),N=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"label"))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"generateReactWidget",value:function(e,t){return i.createElement(E,{node:t,diagramEngine:e})}},{key:"getNewInstance",value:function(e){return new k(!1,null,"label")}}]),t}(l.AbstractNodeFactory),O=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"custom"))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getNewInstance",value:function(e){return new f("custom",!0,!1)}}]),t}(l.AbstractPortFactory),P=function(e){function t(e){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"custom",e))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getClassName",value:function(){return Object(d.a)(Object(c.a)(t.prototype),"getClassName",this).call(this)+(this.props.model.in,this.bem("--in"))}},{key:"render",value:function(){var e,t={display:"inline-block",marginRight:"5px"};this.props.model.isNamePort?e=n.a.createElement(l.PortWidget,{node:this.props.model.getParent(),name:this.props.model.name}):(this.props.model.setLocked(),e=n.a.createElement(l.PortWidget,{node:this.props.model.getParent(),name:this.props.model.name}));var a=n.a.createElement("div",{className:"name"},n.a.createElement("div",null,this.props.model.label," ",void 0!==this.props.model.propertyType?this.props.model.propertyType:null)),i=this.props.model.isPrimaryKey?n.a.createElement("span",{className:"mi mi-Permissions",style:{paddingLeft:5,paddingRight:5,color:"black",fontWeight:800}}):null;return this.props.model.isNamePort?n.a.createElement("div",{style:{marginRight:"5px"}},e):n.a.createElement("div",Object.assign({style:{display:"flex",justifyContent:"flex-end"}},this.getProps()),n.a.createElement("div",{style:t},i),n.a.createElement("div",{style:t},a),n.a.createElement("div",{style:{display:"none"}},e))}}]),t}(l.BaseWidget),j=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,"srd-default-node",e))).state={},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"generatePort",value:function(e){return n.a.createElement(P,{model:e,key:e.id})}},{key:"render",value:function(){var e=this.props.node.getPorts(),t=m.map(e,this.generatePort.bind(this)),a=t.filter(function(e){return e.props.model.isNamePort}),i=t.filter(function(e){return!e.props.model.isNamePort});return n.a.createElement("div",Object.assign({},this.getProps(),{style:{background:this.props.node.color}}),n.a.createElement("div",{className:this.bem(this.props.node.isLabel?"":"__title"),style:{wordBreak:"break-word",maxWidth:"200px"}},0!==a.length&&n.a.createElement("div",{style:{marginLeft:"5px"}},this.generatePort(a[1].props.model)),n.a.createElement("div",{className:this.bem("__name")},this.props.node.name),0!==a.length&&this.generatePort(a[0].props.model)),n.a.createElement("div",{className:this.bem("__ports")},n.a.createElement("div",{className:this.bem("__in")},i)))}}]),t}(l.BaseWidget),L=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"custom"))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"generateReactWidget",value:function(e,t){return n.a.createElement(j,{node:t,diagramEngine:e})}},{key:"getNewInstance",value:function(e){return new k(!1,null,"custom")}}]),t}(l.AbstractNodeFactory),C=function(e){function t(e){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"srd-default-label",e))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",this.getProps(),this.props.model.label)}}]),t}(l.BaseWidget),I=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"custom"))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"generateReactWidget",value:function(e,t){return i.createElement(C,{model:t})}},{key:"getNewInstance",value:function(e){return new h("")}}]),t}(l.AbstractLabelFactory),M=a(20),D=M.JumpPointFinder({heuristic:M.Heuristic.manhattan,diagonalMovement:M.DiagonalMovement.Never}),w=function(){function e(t){Object(r.a)(this,e),this.instance=void 0,this.diagramEngine=void 0,this.instance=D,this.diagramEngine=t}return Object(o.a)(e,[{key:"calculateDirectPath",value:function(e,t){var a=this.diagramEngine.getCanvasMatrix(),i=new M.Grid(a);return D.findPath(this.diagramEngine.translateRoutingX(Math.floor(e.x/5)),this.diagramEngine.translateRoutingY(Math.floor(e.y/5)),this.diagramEngine.translateRoutingX(Math.floor(t.x/5)),this.diagramEngine.translateRoutingY(Math.floor(t.y/5)),i)}},{key:"calculateLinkStartEndCoords",value:function(e,t){var a=t.findIndex(function(t){return 0===e[t[1]][t[0]]}),i=t.length-1-t.slice().reverse().findIndex(function(t){return 0===e[t[1]][t[0]]});if(-1!==a&&-1!==i){var n=t.slice(0,a),r=t.slice(i);return{start:{x:t[a][0],y:t[a][1]},end:{x:t[i][0],y:t[i][1]},pathToStart:n,pathToEnd:r}}}},{key:"calculateDynamicPath",value:function(e,t,a,i,n){var r=this,o=new M.Grid(e),l=D.findPath(t.x,t.y,a.x,a.y,o),s=i.concat(l,n).map(function(e){return[r.diagramEngine.translateRoutingX(e[0],!0),r.diagramEngine.translateRoutingY(e[1],!0)]});return M.Util.compressPath(s)}}]),e}(),T=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,"srd-default-link",e))).refLabels=void 0,a.refPaths=void 0,a.pathFinding=void 0,a.addPointToLink=function(e,t){if(!e.shiftKey&&!a.props.diagramEngine.isModelLocked(a.props.link)&&a.props.link.points.length-1<=a.props.diagramEngine.getMaxNumberPointsPerLink()){var i=new l.PointModel(a.props.link,a.props.diagramEngine.getRelativeMousePoint(e));i.setSelected(!0),a.forceUpdate(),a.props.link.addPoint(i,t),a.props.pointAdded(i,e)}},a.findPathAndRelativePositionToRenderLabel=function(e){for(var t=a.refPaths.map(function(e){return e.getTotalLength()}),i=t.reduce(function(e,t){return e+t},0)*(e/(a.props.link.labels.length+1)),n=0;n<a.refPaths.length;){if(i-t[n]<0)return{path:a.refPaths[n],position:i};i-=t[n],n++}},a.calculateLabelPosition=function(e,t){if(a.refLabels[e.id]){var i=a.findPathAndRelativePositionToRenderLabel(t),n=i.path,r=i.position,o=a.refLabels[e.id].offsetWidth,l=a.refLabels[e.id].offsetHeight,s=n.getPointAtLength(r),c={x:s.x-o/2+e.offsetX,y:s.y-l/2+e.offsetY};a.refLabels[e.id].setAttribute("style","transform: translate(".concat(c.x,"px, ").concat(c.y,"px);"))}},a.refLabels={},a.refPaths=[],a.state={selected:!1},e.diagramEngine.isSmartRoutingEnabled()&&(a.pathFinding=new w(a.props.diagramEngine)),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"calculateAllLabelPosition",value:function(){var e=this;m.forEach(this.props.link.labels,function(t,a){e.calculateLabelPosition(t,a+1)})}},{key:"componentDidUpdate",value:function(){this.props.link.labels.length>0&&window.requestAnimationFrame(this.calculateAllLabelPosition.bind(this))}},{key:"componentDidMount",value:function(){this.props.link.labels.length>0&&window.requestAnimationFrame(this.calculateAllLabelPosition.bind(this))}},{key:"generatePoint",value:function(e){var t=this,a=this.props.link.points[e].x,n=this.props.link.points[e].y;return i.createElement("g",{key:"point-"+this.props.link.points[e].id},i.createElement("circle",{cx:a,cy:n,r:5,className:"point "+this.bem("__point")+(this.props.link.points[e].isSelected()?this.bem("--point-selected"):"")}),i.createElement("circle",{onMouseLeave:function(){t.setState({selected:!1})},onMouseEnter:function(){t.setState({selected:!0})},"data-id":this.props.link.points[e].id,"data-linkid":this.props.link.id,cx:a,cy:n,r:15,opacity:0,className:"point "+this.bem("__point")}))}},{key:"generateLabel",value:function(e){var t=this,a=this.props.diagramEngine.canvas;return i.createElement("foreignObject",{key:e.id,className:this.bem("__label"),width:a.offsetWidth,height:a.offsetHeight},i.createElement("div",{ref:function(a){return t.refLabels[e.id]=a}},this.props.diagramEngine.getFactoryForLabel(e).generateReactWidget(this.props.diagramEngine,e)))}},{key:"generateLink",value:function(e,t,a){var n=this,r=this.props,o=i.cloneElement(r.diagramEngine.getFactoryForLink(this.props.link).generateLinkSegment(this.props.link,this,this.state.selected||this.props.link.isSelected(),e),{ref:function(e){return e&&n.refPaths.push(e)}}),l=i.cloneElement(o,Object(g.a)({},t,{strokeLinecap:"round",onMouseLeave:function(){n.setState({selected:!1})},onMouseEnter:function(){n.setState({selected:!0})},ref:null,"data-linkid":this.props.link.getID(),strokeOpacity:this.state.selected?.1:0,strokeWidth:20,onContextMenu:function(){n.props.diagramEngine.isModelLocked(n.props.link)||(event.preventDefault(),n.props.link.remove())}}));return i.createElement("g",{key:"link-"+a},o,l)}},{key:"isSmartRoutingApplicable",value:function(){var e=this.props,t=e.diagramEngine,a=e.link;return!!t.isSmartRoutingEnabled()&&(2===a.points.length&&(null!==a.sourcePort&&null!==a.targetPort))}},{key:"render",value:function(){var e=this,t=this.props.diagramEngine;if(!t.nodesRendered)return null;var a=this.props.link.points,n=[];if(this.isSmartRoutingApplicable()){var r=this.pathFinding.calculateDirectPath(m.first(a),m.last(a)),o=t.getRoutingMatrix(),s=this.pathFinding.calculateLinkStartEndCoords(o,r);if(s){var c=s.start,u=s.end,d=s.pathToStart,p=s.pathToEnd,g=this.pathFinding.calculateDynamicPath(o,c,u,d,p);n.push(this.generateLink(l.Toolkit.generateDynamicPath(g),{onMouseDown:function(t){e.addPointToLink(t,1)}},"0"))}}if(0===n.length)if(2===a.length){Math.abs(a[0].x-a[1].x),Math.abs(a[0].y-a[1].y);Math.abs(a[0].x-a[1].x)<50&&5;var h=a[0],b=a[1];h.x>b.x&&(h=a[1],b=a[0]),n.push(this.generateLink(l.Toolkit.generateCurvePath(h,b,this.props.link.curvyness),{onMouseDown:function(t){e.addPointToLink(t,1)}},"0")),null===this.props.link.targetPort&&n.push(this.generatePoint(1))}else{for(var f=function(t){n.push(e.generateLink(l.Toolkit.generateLinePath(a[t],a[t+1]),{"data-linkid":e.props.link.id,"data-point":t,onMouseDown:function(a){e.addPointToLink(a,t+1)}},t))},y=0;y<a.length-1;y++)f(y);for(var v=1;v<a.length-1;v++)n.push(this.generatePoint(v));null===this.props.link.targetPort&&n.push(this.generatePoint(a.length-1))}this.refPaths=[];var k=this.props.link.labels;return i.createElement("g",this.getProps(),n,k.map(function(t){return e.generateLabel(t)}))}}]),t}(l.BaseWidget);T.defaultProps={color:"black",width:3,link:null,smooth:!1,diagramEngine:null};var S,x=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).call(this,"custom"))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"generateReactWidget",value:function(e,t){return i.createElement(T,{link:t,diagramEngine:e})}},{key:"getNewInstance",value:function(e){return new b("custom")}},{key:"generateLinkSegment",value:function(e,t,a,n){return i.createElement("path",{className:a?t.bem("--path-selected"):"",strokeWidth:e.width,stroke:e.color,d:n})}}]),t}(l.AbstractLinkFactory),A=function(){function e(){Object(r.a)(this,e),this.activeModel=void 0,this.logicModel=void 0,this.diagramEngine=void 0,this.diagramEngine=new l.DiagramEngine,this.diagramEngine.registerNodeFactory(new N),this.diagramEngine.registerLinkFactory(new x),this.diagramEngine.registerLabelFactory(new I),this.diagramEngine.registerNodeFactory(new L),this.diagramEngine.registerPortFactory(new O),this.diagramEngine.installDefaultFactories(),this.newModel()}return Object(o.a)(e,[{key:"newModel",value:function(){this.activeModel=new l.DiagramModel,this.logicModel=new l.DiagramModel,this.diagramEngine.setDiagramModel(this.activeModel)}},{key:"getActiveDiagram",value:function(){return this.diagramEngine.getDiagramModel()}},{key:"getDiagramEngine",value:function(){return this.diagramEngine}},{key:"setLogicModel",value:function(){var e=this,t=this.activeModel.getNodes();Object.keys(t).map(function(a){var i=t[a].clone(),n=t[a].getPorts();Object.keys(n).map(function(e){var t=n[e],a=new v(t.name,t.isNamePort,t.isPrimaryKey,t.isForeignKey,t.isNotNull,t.isAutoincremented,t.isUnique,t.propertyType);i.addPort(a)}),e.logicModel.addNode(i)});var a=this.activeModel.getLinks();Object.keys(a).map(function(t){var i=e.logicModel.getNodes(),n=a[t].sourcePort.getParent(),r=Object.keys(i).filter(function(e){return i[e].name==n.name})[0],o=a[t].targetPort.getParent(),l=Object.keys(i).filter(function(e){return i[e].name==o.name})[0],s=a[t].labels[0].label,c=a[t].labels[2].label;if(s.includes("N")&&c.includes("N")){var u=a[t].properties.clone();u.name=a[t].labels[1].label,u.setPosition(n.x+150,n.y-100),u.addInPort(!0,!0,"",!1,!1,!1,!1,!1,"INT"),u.addInPort(!0,!0,"1",!1,!1,!1,!1,!1,"INT"),u.addInPort(!0,!1,"Id",!0,!1,!0,!0,!0,"INT"),u.addInPort(!0,!1,n.name+"Id",!1,!0,!1,!1,!0,"INT",r),u.addInPort(!0,!1,o.name+"Id",!1,!0,!1,!1,!0,"INT",l),e.logicModel.addNode(u);var d=i[r].ports[1],m=u.ports[""],p=new y("custom","N","1");p.setSourcePort(d),p.setTargetPort(m);var g=i[l],h=u.ports[1],b=g.ports[""],f=new y("custom","1","N");f.setSourcePort(h),f.setTargetPort(b),e.logicModel.addAll(p,f)}else if(s.includes("N")){i[r].addInPort(!0,!1,o.name+"Id",!1,!0,!1,!1,!0,"INT",l);var v=i[r].ports[1],k=i[l].ports[""],E=new y("custom","1","N");E.setSourcePort(v),E.setTargetPort(k),e.logicModel.addLink(E)}else if(c.includes("N")){i[l].addInPort(!0,!1,n.name+"Id",!1,!0,!1,!1,!0,"INT",r);var N=i[l].ports[1],O=i[r].ports[""],P=new y("custom","N","1");P.setSourcePort(N),P.setTargetPort(O),e.logicModel.addLink(P)}else{i[r].addInPort(!0,!1,o.name+"Id",!1,!0,!1,!1,!0,"INT",l);var j=i[r].ports[1],L=i[l].ports[""],C=new y("custom","1","N");C.setSourcePort(j),C.setTargetPort(L),e.logicModel.addLink(C)}}),this.diagramEngine.setDiagramModel(this.logicModel)}},{key:"setConceptualModel",value:function(){this.logicModel=null,this.logicModel=new l.DiagramModel;var e=new l.DiagramModel,t=this.activeModel.getNodes();Object.keys(t).map(function(a){e.addNode(t[a])});var a=this.activeModel.getLinks();Object.keys(a).map(function(t){e.addLink(a[t])}),this.activeModel=e,this.diagramEngine.setDiagramModel(this.activeModel)}},{key:"loadConceptualModel",value:function(e){this.activeModel=e,this.diagramEngine.setDiagramModel(this.activeModel)}},{key:"loadLogicModel",value:function(e){this.logicModel=e,this.diagramEngine.setDiagramModel(this.logicModel)}}]),e}(),K=a(7),F=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return i.createElement("div",{style:{borderColor:this.props.color},draggable:!0,onDragStart:function(t){t.dataTransfer.setData("storm-diagram-node",JSON.stringify(e.props.model))},className:"tray-item"},this.props.name)}}]),t}(i.Component),R=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",{className:"tray"},this.props.children)}}]),t}(i.Component);R.defaultProps={},function(e){e.BIT="BIT",e.TINYINT="TINYINT",e.SMALLINT="SMALLINT",e.INT="INT",e.BIGINT="BIGINT",e["DECIMAL()"]="DECIMAL()",e["NUMERIC()"]="NUMERIC()",e["FLOAT()"]="FLOAT()",e.REAL="REAL",e.DATE="DATE",e.TIME="TIME",e.DATETIME="DATETIME",e.TIMESTAMP="TIMESTAMP",e.YEAR="YEAR",e["CHAR()"]="CHAR()",e["VARCHAR()"]="VARCHAR()",e.TEXT="TEXT",e["NCHAR()"]="NCHAR()",e["NVARCHAR()"]="NVARCHAR()",e.NTEXT="NTEXT",e["BINARY()"]="BINARY()",e["VARBINARY()"]="VARBINARY()",e.IMAGE="IMAGE",e.CLOB="CLOB",e.BLOB="BLOB",e.XML="XML",e.JSON="JSON",e.MONEY="MONEY"}(S||(S={}));a(108);var q=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",{style:this.props.style,className:this.buildClassNameString()},this.props.children)}},{key:"buildClassNameString",value:function(){var e="ms-Grid";return null!=this.props.className&&(e+=" ".concat(this.props.className)),e}}]),t}(i.Component),U=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",{className:this.buildClassNameString()},this.props.children)}},{key:"buildClassNameString",value:function(){var e="ms-Grid-row";return this.props.flex&&(e+=" grid-row-flex"),null!=this.props.className&&(e+=" ".concat(this.props.className)),e}}]),t}(i.Component),z=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.createElement("div",{className:this.buildClassNameString(),onDoubleClick:this.props.onDoubleClick},this.props.children)}},{key:"buildGridColConfigClassNames",value:function(e,t){if(null==t)return"";var a=" ms-".concat(e);return"string"===typeof t?a+=t:(a+=t.size,null!=t.pull&&(a+=" ms-".concat(e,"Pull").concat(t.pull)),null!=t.push&&(a+=" ms-".concat(e,"Push").concat(t.push)),null!=t.offset&&(a+=" ms-".concat(e,"Offset").concat(t.offset)),null!=t.order&&(a+=" grid-flex-order-".concat(e,"-").concat(t.order))),a}},{key:"buildClassNameString",value:function(){var e="ms-Grid-col";return null!=this.props.className&&(e+=" ".concat(this.props.className)),null!=this.props.hidden&&(e+=" ms-hidden".concat(this.props.hidden)),null!=this.props.order&&(e+=" grid-flex-order-".concat(this.props.order)),e+=this.buildGridColConfigClassNames("sm",this.props.sm),e+=this.buildGridColConfigClassNames("md",this.props.md),e+=this.buildGridColConfigClassNames("lg",this.props.lg),e+=this.buildGridColConfigClassNames("xl",this.props.xl),e+=this.buildGridColConfigClassNames("xxl",this.props.xxl),e+=this.buildGridColConfigClassNames("xxxl",this.props.xxxl)}}]),t}(i.Component),B=(a(110),a(79)),W=a.n(B);var _=function(e){var t=n.a.useState(null),a=Object(K.a)(t,2),i=a[0],r=a[1],o=function(){var e=n.a.useState(0),t=Object(K.a)(e,2),a=(t[0],t[1]);return function(){return a(function(e){return++e})}}();n.a.useMemo(function(){r(e.selectedItem)},[e.selectedItem]);var l=function(e,t){e.persist(),i.getPortFromID(t.id).isPrimaryKey=!t.isPrimaryKey,i.getPortFromID(t.id).isNotNull=!!t.isPrimaryKey,i.getPortFromID(t.id).isAutoincremented=!!t.isPrimaryKey,i.getPortFromID(t.id).isUnique=!!t.isPrimaryKey,function(){var e=i&&i.ports&&i.ports;Object.keys(e).map(function(t){return console.log(e[t].isPartialKey=!1)})}(),o()},s=[{dataField:"label",text:"Property Name",formatter:function(e,t){return n.a.createElement("div",{className:"input"},n.a.createElement("input",{style:{width:"100px"},className:"darkInput",type:"text",defaultValue:t.label,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).label=e.target.value}(e,t)}}))}},{style:{paddingLeft:0},dataField:"propertyType",text:"Property Type",formatter:function(e,t){return n.a.createElement("div",{className:"input"},n.a.createElement("input",{style:{width:"100px"},type:"text",list:"types",className:"darkInput",onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).propertyType=e.target.value}(e,t)},defaultValue:t.propertyType}),n.a.createElement("datalist",{id:"types"},Object.values(S).map(function(e){return n.a.createElement("option",{key:e,value:e},e)})))}},{dataField:"isPrimaryKey",text:"Is Primary Key",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:t.isPrimaryKey,onChange:function(e){return l(e,t)}})))}},{dataField:"isForeignKey",text:"Is Foreign Key",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:t.isForeignKey,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).isForeignKey=!t.isForeignKey,i.getPortFromID(t.id).isNotNull=!!t.isForeignKey,o()}(e,t)}})))}},{dataField:"isPartialKey",text:"Is Partial Key",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{type:"checkbox",checked:t.isPartialKey,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).isPartialKey=!t.isPartialKey,o()}(e,t)}})))}},{dataField:"isNotNull",text:"Not Null",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{disabled:t.isPrimaryKey||t.isForeignKey,type:"checkbox",checked:t.isNotNull,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).isNotNull=!t.isNotNull,o()}(e,t)}})))}},{dataField:"isAutoincremented",text:"Is Auto Incremented",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{disabled:t.isPrimaryKey,type:"checkbox",checked:t.isAutoincremented,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).isAutoincremented=!t.isAutoincremented,o()}(e,t)}})))}},{dataField:"isUnique",text:"Is Unique",formatter:function(e,t){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("input",{disabled:t.isPrimaryKey,type:"checkbox",checked:t.isUnique,onChange:function(e){return function(e,t){e.persist(),i.getPortFromID(t.id).isUnique=!t.isUnique,o()}(e,t)}})))}},{dataField:"remove",text:"Remove",formatter:function(t,a){return n.a.createElement("div",{className:"checkbox"},n.a.createElement("label",null,n.a.createElement("span",{onClick:function(){return function(t){0!==Object.entries(t.links).length&&t.links.constructor===Object&&Object.keys(t.links).map(function(e){return t.links[e]}).forEach(function(t){return e.diagramEngine.getDiagramModel().removeLink(t)});i.removePort(t),o()}(a)},className:"mi mi-Delete red"})))}}],c=i&&i.ports&&i.ports,u=c&&Object.keys(c).map(function(e){return c[e]}).filter(function(e){return!e.isNamePort}),d=s;return!(!u||!u.find(function(e){return e.isPrimaryKey}))&&(d=d.filter(function(e){return"isPartialKey"!==e.dataField})),e.isLogic||(d=d.filter(function(e){return"isForeignKey"!==e.dataField})),n.a.createElement("div",null,n.a.createElement(W.a,{keyField:"id",data:u,columns:e.relView?d.filter(function(e){return"isPrimaryKey"!==e.dataField&&"isPartialKey"!==e.dataField}):d,bordered:!1}),n.a.createElement("p",{className:"mouse-cursor",onClick:function(){return t=u.length,i.addInPort(e.isLogic,!1,"new atribute ".concat(t),!1,!1,!1,!1,!1,S.INT),void o();var t}},"Add new atribute"))};function G(){var e=i.useState(0),t=Object(K.a)(e,2),a=(t[0],t[1]);return function(){return a(function(e){return++e})}}var V=function(e){var t=i.useState(null),a=Object(K.a)(t,2),n=a[0],r=a[1],o=i.useState(""),l=Object(K.a)(o,2),s=l[0],c=l[1],u=i.useState(""),d=Object(K.a)(u,2),m=d[0],p=d[1],g=i.useState(!1),h=Object(K.a)(g,2),b=h[0],f=h[1],y=G();i.useMemo(function(){r(e.selectedItem),p(e.selectedItem.name),c(e.selectedItem.name)},[e.selectedItem]);var v=function(t){t.persist();var a=e.diagramEngine.diagramModel.getNodes();Object.values(a).map(function(e){return a[e.id].name.toLowerCase().trim()}).includes(t.target.value.toLowerCase().trim())?n.name=s:n.name=t.target.value.trim(),y()};return n?i.createElement("div",{className:"trayBottom"},i.createElement(q,null,i.createElement(U,null,i.createElement(z,null,b?e.selectedItem.isLabel?i.createElement("textarea",{style:{height:"200px"},className:"darkInput fs-24",defaultValue:m,onChange:function(e){return v(e)}}):i.createElement("input",{className:"darkInput fs-24",defaultValue:m,onChange:function(e){return v(e)}}):i.createElement("h1",{style:{wordBreak:"break-all"},onDoubleClick:function(){return f(!0)}},m)),n.isLabel?null:i.createElement(_,{selectedItem:e.selectedItem,diagramEngine:e.diagramEngine,isLogic:e.isLogic})))):null},Y=a(47),H=a.n(Y),J=a(80),X=(a(163),a(15)),Q=a(48),$=a.n(Q),Z=a(26),ee=a.n(Z),te=function(e){var t=Object(i.useState)("DatabaseName"),a=Object(K.a)(t,2),r=a[0],o=a[1],l=Object(i.useState)(!1),s=Object(K.a)(l,2),c=s[0],u=s[1],d=e.mssqlString&&$.a.format(e.mssqlString,{language:"sql",indent:"  "}),m=e.mysqlString&&$.a.format(e.mysqlString,{language:"db2",indent:"  "});return n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0},n.a.createElement("div",{className:"sql-result-dialog"},n.a.createElement("input",{style:{marginRight:"10px"},type:"text",onChange:function(e){return o(e.target.value)},value:r}),n.a.createElement("button",{style:{marginRight:"10px"},onClick:function(){e.generateScript(r)}},"Generate"),n.a.createElement("button",{className:"".concat(c?"":"selected-sql"),onClick:function(){u(!1)}},"MSSQL"),n.a.createElement("button",{className:"".concat(c?"selected-sql":""),onClick:function(){u(!0)}},"MySQL"),n.a.createElement("textarea",{style:{marginTop:"5px"},readOnly:!0,value:c?m:d,contentEditable:!1}),n.a.createElement("button",{style:{marginRight:"10px"},onClick:function(){var t=new Blob([d],{type:"text/plain;charset=utf-8"});ee.a.saveAs(t,"".concat(r,".sql")),e.update()}},"Download MSSQL"),n.a.createElement("button",{style:{marginRight:"10px"},onClick:function(){var t=new Blob([m],{type:"text/plain;charset=utf-8"});ee.a.saveAs(t,"".concat(r,".sql")),e.update()}},"Download mySQL")))},ae=a(49),ie=a.n(ae),ne=function(e){var t=Object(i.useState)(""),a=Object(K.a)(t,2),r=a[0],o=a[1],l=Object(i.useState)(""),s=Object(K.a)(l,2),c=s[0],u=s[1];Object(i.useEffect)(function(){return o("")},[e.isOpen]);var d=function(){var t=Object(J.a)(H.a.mark(function t(a){var i,n,r,l;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.serializeDiagram,n=JSON.stringify(i,null,2),console.log("diagram: ",n),t.next=5,ie.a.post("https://sql-generator.pl/api/setjob/mssql",{SerializedModel:n,DatabaseName:a,RelationType:e.isUml?"UML":"CHEN",DiagramType:e.isLogic?"Logic":"Conceptual"});case 5:return r=t.sent,t.next=8,ie.a.post("https://sql-generator.pl/api/setjob/mysql",{SerializedModel:n,DatabaseName:a,RelationType:e.isUml?"UML":"CHEN",DiagramType:e.isLogic?"Logic":"Conceptual"});case 8:l=t.sent,200===r.status&&200===l.status?(o(r.data),u(l.data)):(o("There was an error while processing your request"),u("There was an error while processing your request"),console.log("there was an error while processing your request"));case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(te,{update:e.update,mssqlString:r,mysqlString:c,generateScript:function(e){return d(e)},isOpen:e.isOpen})},re=(a(236),function(e){var t=Object(i.useState)("1, N"),a=Object(K.a)(t,2),r=a[0],o=a[1],l=Object(i.useState)("1, N"),s=Object(K.a)(l,2),c=s[0],u=s[1],d=Object(i.useState)("relation name"),m=Object(K.a)(d,2),p=m[0],g=m[1];n.a.useEffect(function(){var t=e.link&&e.link.labels.length>2&&e.link.labels[0].label,a=e.link&&e.link.labels.length>2&&e.link.labels[1].label,i=e.link&&e.link.labels.length>2&&e.link.labels[2].label;o(t||"1, N"),g(a||"relation name"),u(i||"1, N")},[e.link]);var h=e.link&&e.link.sourcePort&&e.link.sourcePort.parent,b=e.link&&e.link.targetPort&&e.link.targetPort.parent,f=function(){var t=e.link&&e.link.sourcePort,a=e.link&&e.link.targetPort;if(t.removeLink(e.link),a.removeLink(e.link),e.diagramModel.removeLink(e.link),e.isLogic){var i=e.link.targetPort.getParent(),n=e.link.sourcePort.getParent(),r=n.getPorts(),o=i.getPorts(),l=Object.keys(o).filter(function(e){return o[e].fkPortId===n.id})[0],s=Object.keys(r).filter(function(e){return r[e].fkPortId===i.id})[0];l?i.removePort(o[l]):n.removePort(r[s])}e.update()},y=n.a.createElement(n.a.Fragment,null,n.a.createElement("option",{value:"0, N"},"0, N"),n.a.createElement("option",{value:"1, N"},"1, N"),n.a.createElement("option",{value:"0, 1"},"0, 1"),n.a.createElement("option",{value:"1, 1"},"1, 1"),n.a.createElement("option",{value:"N, N"},"N, N")),v=function(e){return n.a.createElement("div",{className:"grid-item"},n.a.createElement("select",{className:"darkSelect",onChange:function(t){return"left"===e?o(t.target.value):u(t.target.value)},value:"left"===e?r:c},y))};return e.isLogic?n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0},n.a.createElement("div",{className:"SQLResultDialog"},n.a.createElement("div",{className:"grid-item"},n.a.createElement("button",{onClick:f},"Remove")),n.a.createElement("div",{className:"grid-item"},n.a.createElement("button",{onClick:function(){var t=e.link.targetPort.getParent(),a=e.link.sourcePort.getParent(),i=a.getPorts(),n=t.getPorts(),r=Object.keys(n).filter(function(e){return n[e].fkPortId===a.id})[0],o=Object.keys(i).filter(function(e){return i[e].fkPortId===t.id})[0];if(r){var l=e.link.labels;l[0].label="1",l[1].label="N",t.removePort(n[r]);var s=Object.keys(n).filter(function(e){return n[e].isPrimaryKey})[0];a.addInPort(!0,!1,t.name+n[s].name,!1,!0,!1,!1,!0,"INT",t.id)}else{var c=e.link.labels;c[0].label="N",c[1].label="1",a.removePort(i[o]);var u=Object.keys(i).filter(function(e){return i[e].isPrimaryKey})[0];t.addInPort(!0,!1,a.name+i[u].name,!1,!0,!1,!1,!0,"INT",t.id)}e.update()}},"Reverse")))):n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0},n.a.createElement("div",{className:"SQLResultDialog"},n.a.createElement("div",{className:"grid-container"},n.a.createElement("div",{className:"grid-item"},n.a.createElement("p",null,h&&h.name)),n.a.createElement("div",{className:"grid-item"},n.a.createElement("input",{className:"darkInput",type:"text",defaultValue:p,onChange:function(e){return g(e.target.value)}})),n.a.createElement("div",{className:"grid-item"},n.a.createElement("p",null,b&&b.name)),v("left"),n.a.createElement("div",{className:"grid-item"},n.a.createElement("button",{onClick:function(){var t=e.link.labels;t[0].label=r,t[2].label=c,t[1].label=p;for(var a=e.link.points,i=1;i<a.length-1;i++)a[i].remove();e.update()}},"SAVE")),v("right"),n.a.createElement("div",{className:"grid-item"}),n.a.createElement("div",{className:"grid-item"},n.a.createElement("button",{onClick:f},"Remove"))),e.link&&r.includes("N")&&c.includes("N")&&n.a.createElement("div",null,n.a.createElement("h3",{style:{margin:0}},"Atributes:"),n.a.createElement(_,{relView:!0,diagramEngine:e.diagramEngine,selectedItem:e.link.properties,isLogic:e.isLogic}))))}),oe=(a(238),function(e){var t,a=Object(i.useState)(""),r=Object(K.a)(a,2),o=r[0],l=r[1],s=function(e){var a=t.result;l(a)};return n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0,onClose:function(){return e.update()}},n.a.createElement("div",{className:"sql-result-dialog"},n.a.createElement("input",{type:"file",onChange:function(e){return a=e.target.files[0],(t=new FileReader).onloadend=s,void t.readAsText(a);var a},accept:".dbjson"}),n.a.createElement("button",{onClick:function(){return e.loadDiagram(o)}},"Load")))}),le=function(e){return n.a.createElement(oe,{update:e.update,loadDiagram:function(t){return function(t){var a=e.app.getDiagramEngine();try{var i=JSON.parse(t);e.setIsUml(i.isUml),i.isLogic?e.setIsLogic(i.isLogic):e.setIsLogic(!1);var n=new l.DiagramModel;n.deSerializeDiagram(i.diagram,a),Object.keys(n.links).map(function(e){return n.links[e]}).forEach(function(e){e.labels.splice(0,3)}),i.isLogic?e.app.loadLogicModel(n):e.app.loadConceptualModel(n),a.repaintCanvas(),e.update()}catch(r){console.log(r)}}(t)},isOpen:e.isOpen})},se=(a(240),function(e){var t=Object(i.useState)("diagram"),a=Object(K.a)(t,2),r=a[0],o=a[1];return n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0,onClose:function(){return e.update()}},n.a.createElement("div",{className:"sql-result-dialog"},n.a.createElement("input",{type:"text",onChange:function(e){return o(e.target.value)},value:r}),n.a.createElement("button",{onClick:function(){var t=JSON.stringify({diagram:e.diagramModel.serializeDiagram(),isUml:e.isUml,isLogic:e.isLogic}),a=new Blob([t],{type:"text/plain;charset=utf-8"});ee.a.saveAs(a,"".concat(r,".dbjson")),e.update()}},"save")))}),ce=(a(242),a(81)),ue=a.n(ce),de=function(e){var t=Object(i.useState)("diagram"),a=Object(K.a)(t,2),r=a[0],o=a[1];return n.a.createElement(X.a,{modal:!0,closeOnDocumentClick:!0,open:e.isOpen,closeOnEscape:!0,onClose:function(){return e.update()}},n.a.createElement("div",{className:"sql-result-dialog"},n.a.createElement("input",{type:"text",onChange:function(e){return o(e.target.value)},value:r}),n.a.createElement("button",{onClick:function(){ue.a.toJpeg(document.getElementById("diagram-layer"),{quality:.95}).then(function(t){var a=document.createElement("a");a.download="".concat(r,".jpeg"),a.href=t,a.click(),e.update()})}},"save")))};a(78),a(27);var me=function(e){var t=i.useRef(null),a=i.useState(!1),n=Object(K.a)(a,2),r=n[0],o=n[1],s=i.useState(!1),c=Object(K.a)(s,2),u=c[0],d=c[1],m=i.useState(!1),g=Object(K.a)(m,2),h=g[0],b=g[1],f=i.useState(!1),y=Object(K.a)(f,2),v=y[0],E=y[1],N=i.useState(!1),O=Object(K.a)(N,2),P=O[0],j=O[1],L=i.useState(!1),C=Object(K.a)(L,2),I=C[0],M=C[1],D=i.useState(null),w=Object(K.a)(D,2),T=w[0],x=w[1],A=i.useState(null),q=Object(K.a)(A,2),U=q[0],z=q[1],B=i.useState(!0),W=Object(K.a)(B,2),_=W[0],Y=W[1],H=i.useState(!1),J=Object(K.a)(H,2),X=J[0],Q=J[1],$=G();i.useEffect(function(){x(null),z(null)},[]);var Z=function(){var t=e.app.getDiagramEngine().getDiagramModel().getLinks();Object.keys(t).map(function(e){var a=t[e].labels[0].label.substring(0,1),i=t[e].labels[2].label.substring(0,1);t[e].labels[0].label=i+t[e].labels[0].label.substring(1),t[e].labels[2].label=a+t[e].labels[2].label.substring(1)})},ee=function(){z(null),x(null),o(!1),E(!1),j(!1),M(!1),b(!1),d(!1);var t=e.app.getDiagramEngine().getDiagramModel().getLinks();Object.keys(t).map(function(a){null==t[a].targetPort&&e.app.getDiagramEngine().getDiagramModel().removeLink(a)})};return i.createElement("div",{className:"body"},i.createElement("div",{className:"header"},i.createElement("div",{className:"title"},"DB Diagram Scripter")),i.createElement("div",{className:"content",ref:null},i.createElement(R,null,i.createElement(F,{model:{type:"table"},name:"Entity",color:"rgb(0,192,255)"}),i.createElement(F,{model:{type:"label"},name:"Label",color:"rgb(192,255,0)"}),i.createElement("div",{style:{borderColor:"rgb(255,123,0)",marginTop:"100px"},className:"tray-item",onClick:function(){e.app.setConceptualModel(),b(!0),x(null)}},"Load Diagram"),i.createElement("div",{style:{display:"flex",justifyContent:"space-between",borderColor:"rgb(255,123,0)"},className:"tray-item",onClick:function(){M(!I),x(null)}},"Save",i.createElement("span",{style:{display:"inline-block",paddingTop:3,paddingRight:5},className:"mi ".concat(I?"mi-ArrowUp8":"mi-ArrowDown8")})),I&&i.createElement("div",{style:{borderColor:"rgb(255,123,0)"},className:"tray-item",onClick:function(){E(!0),x(null)}},"File"),I&&i.createElement("div",{style:{borderColor:"rgb(255,123,0)"},className:"tray-item",onClick:function(){j(!0),x(null)}},"JPEG"),i.createElement("div",{style:{borderColor:"rgb(0,50,100)",marginTop:"100px"},className:"tray-item ".concat(X?"":"selected"),onClick:function(){X&&(e.app.setConceptualModel(),Q(!1))}},"Conceptual View"),i.createElement("div",{style:{borderColor:"rgb(0,50,100)"},className:"tray-item ".concat(X?"selected":""),onClick:function(){X||(e.app.setLogicModel(),Q(!0))}},"Logic View"),i.createElement("div",{style:{borderColor:"rgb(152,50,100)",marginTop:"100px"},className:"tray-item ".concat(_?"selected":"","  ").concat(X?"disabled":""),onClick:function(){X||_||(Z(),Y(!0))}},"UML"),i.createElement("div",{style:{borderColor:"rgb(152,50,100)"},className:"tray-item ".concat(_?"":"selected"," ").concat(X?"disabled":""),onClick:function(){!X&&_&&(Z(),Y(!1))}},"Chen"),i.createElement("div",{style:{borderColor:"rgb(255,0,0)",marginTop:"100px"},className:"tray-item",onClick:function(){o(!0),x(null)}},"Create DB Code")),i.createElement("div",{ref:t,id:"diagram-layer",className:"diagram-layer",onDrop:function(t){t.preventDefault();var a=JSON.parse(t.dataTransfer.getData("storm-diagram-node")),i=e.app.getDiagramEngine().getDiagramModel().getNodes(),n=Object.values(i).map(function(e){return i[e.id].name.toLowerCase().trim()}),r=p.a.keys(e.app.getDiagramEngine().getDiagramModel().getNodes()).length,o=n.includes("Entity".concat(r+1).toLowerCase().trim())?"Entity".concat(r+1,"_").concat(r+1):"Entity".concat(r+1),l=null;"table"===a.type?((l=new k(!1,o,"rgb(0,192,255)")).addInPort(X,!1,"Id",!0,!1,!0,!0,!0,S.INT),l.addInPort(X,!0,"",!1,!1,!1,!1,!1,S.INT),l.addInPort(X,!0,"1",!1,!1,!1,!1,!1,S.INT),l.addListener({})):l=new k(!0,"Label ","rgb(192,255,0)");var s=e.app.getDiagramEngine().getRelativeMousePoint(t);l.x=s.x,l.y=s.y,e.app.getDiagramEngine().getDiagramModel().addNode(l),$()},onDragOver:function(e){e.preventDefault()},onClick:function(t){if(t.preventDefault(),t.ctrlKey&&e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0]instanceof l.PointModel){var a=e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0],i=e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0].parent;i&&e.app.getDiagramEngine().getDiagramModel().links[i.id].removePoint(a)}ee()},onDoubleClick:function(t){t.preventDefault(),e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0]instanceof l.PointModel?(z(e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0].parent),d(!0),x(null)):e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0]instanceof k&&(ee(),x(e.app.getDiagramEngine().getDiagramModel().getSelectedItems()[0]))}},i.createElement(l.DiagramWidget,{allowLooseLinks:!1,deleteKeys:[T?null:46],className:"srd-demo-canvas",diagramEngine:e.app.getDiagramEngine()})),null!=T?i.createElement(V,{isLogic:X,selectedItem:T,diagramEngine:e.app.getDiagramEngine()}):null,i.createElement(ne,{isUml:_,isLogic:X,update:ee,isOpen:r,serializeDiagram:e.app.getDiagramEngine().diagramModel.serializeDiagram()}),i.createElement(le,{update:ee,isOpen:h,app:e.app,setIsUml:Y,setIsLogic:Q}),i.createElement(se,{isLogic:X,update:ee,diagramModel:e.app.getDiagramEngine().diagramModel,isOpen:v,isUml:_}),i.createElement(de,{update:ee,diagramModel:e.app.getActiveDiagram(),isOpen:P}),i.createElement(re,{diagramModel:e.app.getActiveDiagram(),diagramEngine:e.app.getDiagramEngine(),update:ee,isOpen:u,link:U,isLogic:X})))};a(27),a(78);var pe=function(){return i.createElement(me,{app:new A})},ge=a(36);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));ge.render(i.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},82:function(e,t,a){e.exports=a(245)},83:function(e,t,a){},85:function(e,t,a){},87:function(e,t,a){},89:function(e,t,a){}},[[82,2,1]]]);
//# sourceMappingURL=main.f51e92cc.chunk.js.map