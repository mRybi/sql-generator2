{"ast":null,"code":"import _classCallCheck from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport * as _ from \"lodash\";\nimport { PortModel } from \"storm-react-diagrams\";\nimport { Link } from \"./Link\";\nimport { PropertyType } from \"./PropertyType\";\nimport { Node } from \"./Node\";\nimport { RelationType } from \"../../App2\";\nimport { link } from \"fs\";\nexport var Port =\n/*#__PURE__*/\nfunction (_PortModel) {\n  _inherits(Port, _PortModel);\n\n  function Port(isPrimaryKey, isForeignKey, isInput, name) {\n    var _this;\n\n    var label = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n    var selectedRelation = arguments.length > 5 ? arguments[5] : undefined;\n    var diagramModel = arguments.length > 6 ? arguments[6] : undefined;\n    var propertyType = arguments.length > 7 ? arguments[7] : undefined;\n    var id = arguments.length > 8 ? arguments[8] : undefined;\n\n    _classCallCheck(this, Port);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Port).call(this, name, \"with_prop\", id));\n    _this.in = void 0;\n    _this.label = void 0;\n    _this.propertyType = void 0;\n    _this.isPrimaryKey = void 0;\n    _this.isForeignKey = void 0;\n    _this.links = void 0;\n    _this.iterator = 1;\n    _this.firstM2M = 1;\n    _this.selectedRelation = void 0;\n    _this.diagramModel = void 0;\n    _this.in = isInput;\n    _this.label = label || name;\n    _this.links = {};\n    _this.propertyType = propertyType;\n    _this.isForeignKey = isForeignKey;\n    _this.isPrimaryKey = isPrimaryKey;\n    _this.selectedRelation = selectedRelation;\n    _this.diagramModel = diagramModel;\n    return _this;\n  }\n\n  _createClass(Port, [{\n    key: \"updatePortRelation\",\n    value: function updatePortRelation(selectedRelation) {\n      this.selectedRelation = selectedRelation;\n    }\n  }, {\n    key: \"deSerialize\",\n    value: function deSerialize(object, engine) {\n      _get(_getPrototypeOf(Port.prototype), \"deSerialize\", this).call(this, object, engine);\n\n      this.in = object.in;\n      this.label = object.label;\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize() {\n      return _.merge(_get(_getPrototypeOf(Port.prototype), \"serialize\", this).call(this), {\n        in: this.in,\n        label: this.label,\n        propertyType: PropertyType[this.propertyType],\n        isForeignKey: this.isForeignKey,\n        isPrimaryKey: this.isPrimaryKey\n      });\n    }\n  }, {\n    key: \"createM2MNode\",\n    value: function createM2MNode(port1Name, port2Name) {\n      var relationNode = new Node('table', \"rl_\".concat(port1Name, \"Has\").concat(port2Name));\n      relationNode.addInPort(true, false, \"Id\", this.selectedRelation, this.diagramModel, PropertyType.INT);\n      relationNode.addInPort(false, true, \"\".concat(port1Name, \"Id\"), this.selectedRelation, this.diagramModel, PropertyType.INT);\n      relationNode.addInPort(false, true, \"\".concat(port2Name, \"Id\"), this.selectedRelation, this.diagramModel, PropertyType.INT);\n      this.diagramModel.addNode(relationNode);\n      return relationNode;\n    }\n  }, {\n    key: \"link\",\n    value: function link(nodeToLink) {\n      //dalczego  przypina do zlego portu?\n      var thisPortNode = this.getNode();\n      var ports = nodeToLink.getInPorts();\n      var isThereAlreadyThatPort = ports.filter(function (p) {\n        return p.label === \"\".concat(thisPortNode.name, \"Id\");\n      }).length;\n\n      if (isThereAlreadyThatPort === 0) {\n        if (this.selectedRelation === RelationType.M2M) {\n          var _link = this.createLinkModel();\n\n          _link.setSourcePort(this);\n\n          var _ports = nodeToLink.getInPorts();\n\n          _link.setTargetPort(_ports.filter(function (p) {\n            return p.label === 'Id';\n          })[0]);\n\n          return _link;\n        } else {\n          var _link2 = this.createLinkModel();\n\n          var newPort = nodeToLink.addInPort(false, true, \"\".concat(thisPortNode.name, \"Id\"), this.selectedRelation, this.diagramModel, PropertyType.INT);\n          console.log('newPort', newPort);\n\n          _link2.setSourcePort(this);\n\n          _link2.setTargetPort(newPort);\n\n          console.log('NEWLINK', _link2);\n          return _link2;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"relationLink\",\n    value: function relationLink(node1, relationtNode, node2) {\n      var link1 = this.createLinkModel();\n      var link2 = this.createLinkModel();\n      link1.setSourcePort(node1.getInPorts().filter(function (p) {\n        return p.label === 'Id';\n      })[0]);\n      link1.setTargetPort(relationtNode.getInPorts().filter(function (p) {\n        return p.label === 'Id';\n      })[0]);\n      return link; // link2.setSourcePort(relationtNode.getInPorts().filter(p => p.label === 'Id')[0])\n      // link2.setTargetPort(node2.getInPorts().filter(p => p.label === 'Id')[0])\n    }\n  }, {\n    key: \"canLinkToPort\",\n    value: function canLinkToPort(port) {\n      if (port instanceof Port) {\n        if (this.selectedRelation !== RelationType.M2M && (this.isPrimaryKey && port.isPrimaryKey || this.isPrimaryKey && port.isForeignKey || this.isForeignKey && port.isPrimaryKey)) {\n          var _nodeToLink = port.getNode();\n\n          this.link(_nodeToLink);\n          console.log('in if');\n        }\n\n        console.log('out if'); // else if(this.selectedRelation === RelationType.M2M || this.firstM2M === 1){\t\t\n\n        var nodeToLink = port.getNode();\n        var relNode = this.createM2MNode(this.getNode().name, nodeToLink.name);\n        this.relationLink(this.getNode(), relNode, port.getNode());\n        console.log('out if2');\n        return false; // \n        // \t\t\tthis.link(relationNode);\n        // \t\t\tthis.iterator = 0;\n        // \t\t\tthis.firstM2M = 0;\n        // \t\t\treturn false;\n        // }\n        // return (this.isPrimaryKey && port.isForeignKey || this.isForeignKey && port.isPrimaryKey) ? true : false\n\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"createLinkModel\",\n    value: function createLinkModel() {\n      var link = _get(_getPrototypeOf(Port.prototype), \"createLinkModel\", this).call(this);\n\n      if (this.selectedRelation === RelationType.O2O) {\n        return new Link(\"default\", RelationType.O2O);\n      } else if (this.selectedRelation === RelationType.O2M) {\n        return new Link(\"default\", RelationType.O2M);\n      } else {\n        return new Link(\"default\", RelationType.M2M);\n      }\n    }\n  }]);\n\n  return Port;\n}(PortModel);","map":{"version":3,"sources":["/home/dell/Dokumenty/sql-gen2/sql-gen2/sql-generator2/src/components/models/Port.ts"],"names":["_","PortModel","Link","PropertyType","Node","RelationType","link","Port","isPrimaryKey","isForeignKey","isInput","name","label","selectedRelation","diagramModel","propertyType","id","in","links","iterator","firstM2M","object","engine","merge","port1Name","port2Name","relationNode","addInPort","INT","addNode","nodeToLink","thisPortNode","getNode","ports","getInPorts","isThereAlreadyThatPort","filter","p","length","M2M","createLinkModel","setSourcePort","setTargetPort","newPort","console","log","node1","relationtNode","node2","link1","link2","port","relNode","createM2MNode","relationLink","O2O","O2M"],"mappings":"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","sourcesContent":["import * as _ from \"lodash\";\nimport { PortModel, DiagramEngine, LinkModel, DefaultLinkModel, NodeModel, DiagramModel } from \"storm-react-diagrams\";\nimport { Link } from \"./Link\";\nimport { PropertyType } from \"./PropertyType\";\nimport { Node } from \"./Node\";\nimport { RelationType } from \"../../App2\";\nimport { Application } from \"../dragAndDrop/Application\";\nimport { link } from \"fs\";\n\nexport class Port extends PortModel {\n\tin: boolean;\n    label: string;\n\tpropertyType: PropertyType;\n\tisPrimaryKey: boolean;\n\tisForeignKey: boolean;\n\tlinks: { [id: string]: Link };\n\titerator: number = 1;\n\tfirstM2M: number = 1;\n\tselectedRelation: RelationType;\n\tdiagramModel: DiagramModel;\n\n\tconstructor(isPrimaryKey: boolean, isForeignKey: boolean, isInput: boolean, name: string, label: string = null, selectedRelation: RelationType, diagramModel?: DiagramModel ,propertyType?: PropertyType, id?: string) {\n\t\tsuper(name, \"with_prop\", id);\n\t\tthis.in = isInput;\n        this.label = label || name;\n        this.links = {};\n\t\tthis.propertyType = propertyType;\n\t\tthis.isForeignKey = isForeignKey;\n\t\tthis.isPrimaryKey = isPrimaryKey;\n\t\tthis.selectedRelation = selectedRelation;\n\t\tthis.diagramModel= diagramModel;\n\t}\n\n\tupdatePortRelation(selectedRelation: RelationType) {\n\t\tthis.selectedRelation = selectedRelation;\n\t}\n\n\tdeSerialize(object: any, engine: DiagramEngine) {\n\t\tsuper.deSerialize(object, engine);\n\t\tthis.in = object.in;\n\t\tthis.label = object.label;\n\t}\n\n\tserialize() {\n\t\treturn _.merge(super.serialize(), {\n\t\t\tin: this.in,\n            label: this.label,\n\t\t\tpropertyType: PropertyType[this.propertyType],\n\t\t\tisForeignKey: this.isForeignKey,\n\t\t\tisPrimaryKey: this.isPrimaryKey\n\t\t});\n\t}\n\n\tcreateM2MNode(port1Name: string, port2Name: string) {\t\t\t\t\n\t\tlet relationNode = new Node('table', `rl_${port1Name}Has${port2Name}`);\n\t\trelationNode.addInPort(true, false, `Id`, this.selectedRelation, this.diagramModel, PropertyType.INT)\n\t\trelationNode.addInPort(false, true, `${port1Name}Id`, this.selectedRelation, this.diagramModel, PropertyType.INT)\n\t\trelationNode.addInPort(false, true, `${port2Name}Id`, this.selectedRelation, this.diagramModel, PropertyType.INT)\n\t\tthis.diagramModel.addNode(relationNode);\n\t\treturn relationNode;\n\t}\n\n\tlink(nodeToLink: Node): LinkModel {\n//dalczego  przypina do zlego portu?\n\n\tlet thisPortNode = this.getNode() as Node;\n\tlet ports = nodeToLink.getInPorts();\n\tlet isThereAlreadyThatPort = ports.filter(p => p.label === `${thisPortNode.name}Id`).length;\n\tif(isThereAlreadyThatPort === 0) {\n\t\tif(this.selectedRelation === RelationType.M2M) {\n\t\t\tlet link = this.createLinkModel();\n\n\t\t\tlink.setSourcePort(this);\n\t\t\tlet ports = nodeToLink.getInPorts();\n\t\t\tlink.setTargetPort(ports.filter(p => p.label === 'Id')[0]);\n\n\t\t\treturn link;\n\t\t} else {\n\t\t\tlet link = this.createLinkModel();\n\t\t\t\n\t\t\tlet newPort = nodeToLink.addInPort(false, true, `${thisPortNode.name}Id`, this.selectedRelation, this.diagramModel, PropertyType.INT);\n\t\t\tconsole.log('newPort', newPort);\n\t\n\t\t\tlink.setSourcePort(this);\n\t\t\t\n\t\t\tlink.setTargetPort(newPort);\n\t\t\tconsole.log('NEWLINK', link);\n\t\t\treturn link;\n\t\t}\n\t} \n\treturn null;\n\t}\n\n\trelationLink(node1: Node, relationtNode: Node, node2: Node) {\n\t\tlet link1 = this.createLinkModel();\n\t\tlet link2 = this.createLinkModel();\n\n\t\tlink1.setSourcePort(node1.getInPorts().filter(p => p.label === 'Id')[0])\n\t\tlink1.setTargetPort(relationtNode.getInPorts().filter(p => p.label === 'Id')[0])\nreturn link;\n\t\t// link2.setSourcePort(relationtNode.getInPorts().filter(p => p.label === 'Id')[0])\n\t\t// link2.setTargetPort(node2.getInPorts().filter(p => p.label === 'Id')[0])\n\n\t}\n\n\tcanLinkToPort(port: PortModel): boolean {\n\t\tif (port instanceof Port) {\n\t\t\tif(this.selectedRelation !== RelationType.M2M &&(this.isPrimaryKey && port.isPrimaryKey || this.isPrimaryKey && port.isForeignKey || this.isForeignKey && port.isPrimaryKey)) {\t\t\n\t\t\t\tlet nodeToLink = port.getNode() as Node;\n\t\t\t\tthis.link(nodeToLink);\n\t\t\t\tconsole.log('in if');\n\t\t\t} \n\t\t\tconsole.log('out if');\n\n\t\t\t// else if(this.selectedRelation === RelationType.M2M || this.firstM2M === 1){\t\t\n\t \t\t\tlet nodeToLink = port.getNode() as Node;\n\t\t\t\tlet relNode = this.createM2MNode((this.getNode() as Node).name, nodeToLink.name);\n\t\t\t\tthis.relationLink(this.getNode() as Node, relNode, port.getNode() as Node);\n\t\t\tconsole.log('out if2');\n\t\t\treturn false;\n\t\t\t// \n\t// \t\t\tthis.link(relationNode);\n\t\t\t\t\n\t// \t\t\tthis.iterator = 0;\n\t// \t\t\tthis.firstM2M = 0;\n\t// \t\t\treturn false;\n\t\t\t\t\n\t\t\t// }\n\n\n\t\t\t// return (this.isPrimaryKey && port.isForeignKey || this.isForeignKey && port.isPrimaryKey) ? true : false\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t\t\n\t\t\n\t}\n\n\tcreateLinkModel(): LinkModel {\n\t\tlet link = super.createLinkModel();\n\t\tif (this.selectedRelation === RelationType.O2O) {\n\t\t\treturn new Link(\"default\", RelationType.O2O);\n\t\t} else if (this.selectedRelation === RelationType.O2M) {\n\t\t\treturn new Link(\"default\", RelationType.O2M);\n\t\t} else {\n\t\t\treturn new Link(\"default\", RelationType.M2M);\n\t\t}\n\t\t\n\t}\n}"]},"metadata":{},"sourceType":"module"}